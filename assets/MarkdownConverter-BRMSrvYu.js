import{d as D,z as k,S as E,c as f,a as t,e as s,f as d,w as o,u as i,y as h,r as c,I as N,T as I,U as S,F as y,i as $,K as q,j as C,x as M,L as G,V as K,O as J,o as p,t as V,P as _,_ as Q}from"./index-lIIOFO3D.js";const X={class:"markdown-converter-page animate-fade-in"},Y={class:"page-header"},Z={class:"title-section"},ee={class:"page-title gradient-text-premium indigo"},te={class:"content-grid"},se={class:"editor-section"},le={class:"card-premium"},oe={class:"card-header-premium"},ae={class:"card-title-premium"},ne={class:"header-actions"},de={class:"template-group"},ie={class:"template-wrapper"},re={class:"preview-section"},ue={class:"card-premium"},ce={class:"card-header-premium"},pe={class:"card-title-premium"},me={class:"header-actions"},_e={class:"preview-canvas glass"},ve=["innerHTML"],fe={class:"export-zone card-premium"},ge={class:"export-header"},be={class:"export-info"},we={class:"export-title"},xe={class:"export-actions"},ke={class:"syntax-guide-section card-premium"},he={class:"guide-header"},ye={class:"guide-grid"},$e={class:"syntax-box"},Ce={class:"output-box"},Me=["innerHTML"],Ve=D({__name:"MarkdownConverter",setup(Le){const r=k(""),g=k("preview"),L=[{name:"学术论文",content:`# 论文标题

## 摘要
这里是摘要内容...

## 1. 引言
这里是引言内容...

## 2. 方法
这里是方法描述...

## 参考文献
[1] 文献 A`},{name:"项目报告",content:`# 项目报告

**日期：** 2024-01-01
**作者：** OneWriter

## 核心目标
- 目标 1
- 目标 2`}],T=[{title:"标题体系",syntax:`# 一级
## 二级
### 三级`,result:"<h1>一级</h1><h2>二级</h2><h3>三级</h3>"},{title:"文本强化",syntax:"**粗体** *斜体* ~~删除~~",result:"<strong>粗体</strong> <em>斜体</em> <del>删除</del>"}],m=E(()=>{let l=r.value;return l=l.replace(/^### (.*$)/gim,"<h3>$1</h3>"),l=l.replace(/^## (.*$)/gim,"<h2>$1</h2>"),l=l.replace(/^# (.*$)/gim,"<h1>$1</h1>"),l=l.replace(/\*\*(.*?)\*\*/gim,"<strong>$1</strong>"),l=l.replace(/\*(.*?)\*/gim,"<em>$1</em>"),l=l.replace(/\[(.*?)\]\((.*?)\)/gim,'<a href="$2">$1</a>'),l=l.replace(/^\- (.*$)/gim,"<li>$1</li>"),l=l.replace(/\n\n/g,"</p><p>"),l="<p>"+l+"</p>",l}),U=l=>{r.value=l.content,_.success(`已加载模板: ${l.name}`)},H=()=>r.value="",z=l=>{const e=new FileReader;return e.onload=a=>{r.value=a.target?.result,_.success("文档载入成功")},e.readAsText(l),!1},F=()=>{const l=new Blob([m.value],{type:"application/msword"});b(l,"export.doc"),_.success("Word 导出成功")},B=()=>{const l=new Blob([m.value],{type:"text/html"});b(l,"export.html"),_.success("HTML 导出成功")},A=()=>{_.info("正在调用系统打印功能生成 PDF..."),window.print()},b=(l,e)=>{const a=URL.createObjectURL(l),u=document.createElement("a");u.href=a,u.download=e,u.click(),URL.revokeObjectURL(a)};return(l,e)=>{const a=c("el-icon"),u=c("el-button"),R=c("el-upload"),w=c("el-input"),x=c("el-radio-button"),W=c("el-radio-group"),O=c("el-empty"),P=c("el-collapse-item"),j=c("el-collapse");return p(),f("div",X,[t("div",Y,[t("div",Z,[t("h1",ee,[s(a,{class:"title-icon"},{default:o(()=>[s(i(h))]),_:1}),e[3]||(e[3]=d(" Markdown 智能转 Word ",-1))]),e[4]||(e[4]=t("p",{class:"page-subtitle"},"毫秒级转换，保持完美排版，支持自定义模板导出",-1))])]),t("div",te,[t("div",se,[t("div",le,[t("div",oe,[t("span",ae,[s(a,null,{default:o(()=>[s(i(N))]),_:1}),e[5]||(e[5]=d(" 文本编辑器 ",-1))]),t("div",ne,[s(R,{"before-upload":z,"show-file-list":!1,accept:".md,.markdown,.txt"},{default:o(()=>[s(u,{class:"round-btn"},{default:o(()=>[s(a,null,{default:o(()=>[s(i(I))]),_:1}),e[6]||(e[6]=d(" 上传 ",-1))]),_:1})]),_:1}),s(u,{onClick:H,class:"round-btn"},{default:o(()=>[s(a,null,{default:o(()=>[s(i(S))]),_:1}),e[7]||(e[7]=d(" 清空 ",-1))]),_:1})])]),s(w,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n),type:"textarea",rows:20,placeholder:"在此键入 Markdown 文档...",class:"premium-textarea"},null,8,["modelValue"]),t("div",de,[e[8]||(e[8]=t("h3",{class:"group-title"},"快捷预设",-1)),t("div",ie,[(p(),f(y,null,$(L,(n,v)=>s(u,{key:v,onClick:Te=>U(n),class:"template-btn",ghost:""},{default:o(()=>[d(V(n.name),1)]),_:2},1032,["onClick"])),64))])])])]),t("div",re,[t("div",ue,[t("div",ce,[t("span",pe,[s(a,null,{default:o(()=>[s(i(q))]),_:1}),e[9]||(e[9]=d(" 实时排版预览 ",-1))]),t("div",me,[s(W,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=n=>g.value=n),size:"small",class:"premium-radio"},{default:o(()=>[s(x,{label:"preview"},{default:o(()=>[...e[10]||(e[10]=[d("渲染",-1)])]),_:1}),s(x,{label:"html"},{default:o(()=>[...e[11]||(e[11]=[d("代码",-1)])]),_:1})]),_:1},8,["modelValue"])])]),t("div",_e,[r.value?g.value==="preview"?(p(),f("div",{key:1,class:"markdown-body",innerHTML:m.value},null,8,ve)):(p(),C(w,{key:2,modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=n=>m.value=n),type:"textarea",rows:20,readonly:"",class:"html-viewer"},null,8,["modelValue"])):(p(),C(O,{key:0,description:"等待解析您的文档"},{image:o(()=>[s(a,{size:80,class:"empty-icon"},{default:o(()=>[s(i(M))]),_:1})]),_:1}))])])])]),t("div",fe,[t("div",ge,[t("div",be,[t("h3",we,[s(a,null,{default:o(()=>[s(i(G))]),_:1}),e[12]||(e[12]=d(" 导出与分发 ",-1))]),e[13]||(e[13]=t("p",{class:"export-desc"},"一键转换至主流文档格式，确保跨平台兼容性",-1))]),t("div",xe,[s(u,{type:"primary",size:"large",onClick:F,class:"action-btn-primary indigo-bg",disabled:!r.value},{default:o(()=>[s(a,null,{default:o(()=>[s(i(h))]),_:1}),e[14]||(e[14]=d(" 导出为 Word ",-1))]),_:1},8,["disabled"]),s(u,{size:"large",onClick:B,class:"action-btn",disabled:!r.value},{default:o(()=>[s(a,null,{default:o(()=>[s(i(M))]),_:1}),e[15]||(e[15]=d(" 导出 HTML ",-1))]),_:1},8,["disabled"]),s(u,{size:"large",onClick:A,class:"action-btn",disabled:!r.value},{default:o(()=>[s(a,null,{default:o(()=>[s(i(K))]),_:1}),e[16]||(e[16]=d(" 转换为 PDF ",-1))]),_:1},8,["disabled"])])])]),t("div",ke,[t("div",he,[s(a,null,{default:o(()=>[s(i(J))]),_:1}),e[17]||(e[17]=t("span",null,"Markdown 语法指南",-1))]),s(j,{class:"premium-collapse"},{default:o(()=>[(p(),f(y,null,$(T,(n,v)=>s(P,{key:v,title:n.title,name:v},{default:o(()=>[t("div",ye,[t("div",$e,[e[18]||(e[18]=t("span",{class:"label"},"代码",-1)),t("pre",null,[t("code",null,V(n.syntax),1)])]),t("div",Ce,[e[19]||(e[19]=t("span",{class:"label"},"解析效果",-1)),t("div",{class:"output-content",innerHTML:n.result},null,8,Me)])])]),_:2},1032,["title","name"])),64))]),_:1})])])}}}),He=Q(Ve,[["__scopeId","data-v-87a448e5"]]);export{He as default};
